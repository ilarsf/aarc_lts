---
layout: default
title: "Boathouse Rules and Safety Quiz"
---

<div class="quiz-container">
    <div id="quiz-header">
        <h1>AARC Boathouse Rules and Safety Quiz</h1>
        <p>Test your knowledge about boathouse rules, equipment care, and safety procedures. Each quiz consists of 10 randomly selected questions from our catalog. See if you can make it to the high score board!</p>
    </div>

    <div id="start-screen" class="quiz-section">
        <h2>Ready to test your knowledge?</h2>
        <div class="input-group">
            <label for="username">Enter your name:</label>
            <input type="text" id="username" placeholder="Your name">
        </div>
        <button id="start-button" class="quiz-button">Start Quiz</button>
        <button id="view-highscores" class="quiz-button secondary">View High Scores</button>
    </div>

    <div id="quiz-screen" class="quiz-section hidden">
        <div id="quiz-info">
            <span id="question-counter">Question 1/10</span>
            <span id="timer">Time: 0:00</span>
            <span id="score-display">Score: 0</span>
        </div>
        <div id="question-container">
            <h2 id="question-text">Question text goes here</h2>
            <div id="answers-container">
                </div>
        </div>
        <div id="feedback" class="hidden">
            <p id="feedback-text"></p>
        </div>
    </div>

    <div id="results-screen" class="quiz-section hidden">
        <h2>Quiz Complete!</h2>
        <div id="quiz-summary">
            <p>Your score: <span id="final-score">0</span> points</p>
            <p>Time taken: <span id="time-taken">0:00</span></p>
            <p>Correct answers: <span id="correct-count">0</span>/10</p>
        </div>
        <div id="high-score-message"></div>
        <div class="button-group">
            <button id="restart-button" class="quiz-button">Take Quiz Again</button>
            <button id="review-button" class="quiz-button secondary">Review Answers</button>
            <button id="highscores-button" class="quiz-button secondary">View High Scores</button>
        </div>
    </div>

    <div id="review-screen" class="quiz-section hidden">
        <h2>Review Your Answers</h2>
        <div id="review-container">
            </div>
        <button id="back-to-results" class="quiz-button">Back to Results</button>
    </div>

    <div id="highscores-screen" class="quiz-section hidden">
        <h2>High Scores</h2>
        <div id="highscores-container">
            <table id="highscores-table">
                <thead>
                    <tr>
                        <th>Rank</th>
                        <th>Name</th>
                        <th>Score</th>
                        <th>Time</th>
                        <th>Date</th>
                    </tr>
                </thead>
                <tbody id="highscores-body">
                    </tbody>
            </table>
        </div>
        <div id="no-scores-message" class="hidden">
            <p>No high scores yet. Be the first to set a record!</p>
        </div>
        <div class="button-group">
            <button id="back-button" class="quiz-button">Back</button>
            <button id="clear-scores" class="quiz-button secondary">Clear High Scores (Admin)</button>
        </div>
    </div>
</div>

<style>
    .quiz-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f8f9fa;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    #quiz-header {
        text-align: center;
        margin-bottom: 30px;
    }

    .quiz-section {
        margin-bottom: 30px;
    }

    .hidden {
        display: none;
    }

    #quiz-info {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        font-weight: bold;
    }

    .input-group {
        margin-bottom: 20px;
    }

    .input-group label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
    }

    .input-group input {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 16px;
    }

    .quiz-button {
        display: block;
        width: 100%;
        padding: 12px;
        background-color: #0077cc; /* AARC Blue approx */
        color: white;
        border: none;
        border-radius: 5px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        margin-bottom: 10px;
        transition: background-color 0.3s;
    }

    .quiz-button:hover {
        background-color: #005fa3; /* Darker blue */
    }

    .quiz-button.secondary {
        background-color: #6c757d;
    }

    .quiz-button.secondary:hover {
        background-color: #5a6268;
    }

    .button-group {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .button-group .quiz-button {
        flex: 1;
        min-width: 200px;
    }

    #answers-container {
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .answer-button {
        padding: 12px;
        background-color: #f0f0f0;
        border: 1px solid #ddd;
        border-radius: 5px;
        text-align: left;
        font-size: 16px;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .answer-button:hover:not(:disabled) {
        background-color: #e2e6ea;
    }
     .answer-button:disabled {
        cursor: default;
        opacity: 0.7;
    }

    .correct {
        background-color: #d4edda !important;
        border-color: #c3e6cb !important;
        font-weight: bold;
    }

    .incorrect {
        background-color: #f8d7da !important;
        border-color: #f5c6cb !important;
    }

    #feedback {
        margin: 20px 0;
        padding: 15px;
        border-radius: 5px;
        background-color: #f8f9fa;
        border-left: 4px solid #0077cc;
    }
    
    #feedback.correct-feedback {
        border-left-color: #28a745;
    }
    #feedback.incorrect-feedback {
         border-left-color: #dc3545;
    }

    #quiz-summary {
        margin: 20px 0;
        padding: 20px;
        background-color: #e9ecef;
        border-radius: 5px;
    }

    #high-score-message {
        margin: 20px 0;
        padding: 15px;
        border-radius: 5px;
        text-align: center;
        font-weight: bold;
    }
    #high-score-message p.success {
      color: #155724;
      background-color: #d4edda;
      border: 1px solid #c3e6cb;
      padding: 10px;
      border-radius: 4px;
    }


    .review-item {
        margin-bottom: 20px;
        padding: 15px;
        border-radius: 5px;
        border: 1px solid #ddd;
        background-color: #fff;
    }

    .review-question {
        font-weight: bold;
        margin-bottom: 10px;
    }

    .review-answers {
        margin-left: 20px;
    }

    .review-correct {
        color: #28a745;
        font-weight: bold;
    }
     .review-correct::before {
        content: '✔ ';
        color: #28a745;
    }


    .review-incorrect {
        color: #dc3545;
        text-decoration: line-through;
    }
     .review-incorrect.user-answer::before {
         content: '✘ ';
         color: #dc3545;
         text-decoration: none; /* Prevent strikethrough on icon */
         display: inline-block; /* Ensure icon aligns correctly */
         margin-right: 3px;
     }
     .review-incorrect.user-answer {
          font-style: italic;
     }

    .review-explanation {
        margin-top: 10px;
        padding: 10px;
        background-color: #f8f9fa;
        border-left: 4px solid #6c757d;
        font-size: 0.9em;
    }

    #highscores-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 20px;
    }

    #highscores-table th, #highscores-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }

    #highscores-table th {
        background-color: #f2f2f2;
        font-weight: bold;
    }

    #highscores-table tr:nth-child(even) {
        background-color: #f8f9fa;
    }

    #highscores-table tr:hover {
        background-color: #e9ecef;
    }

    #no-scores-message {
        text-align: center;
        padding: 20px;
    }

    @media (max-width: 600px) {
        .button-group {
            flex-direction: column;
        }

        #quiz-info {
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        #highscores-table {
            font-size: 14px;
        }

        #highscores-table th, #highscores-table td {
            padding: 8px;
        }
         .review-incorrect.user-answer::before {
             display: none; /* Simplify for mobile */
         }
         .review-correct::before {
            display: none; /* Simplify for mobile */
        }

    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Quiz questions database (50 questions total)
        const quizQuestions = [
            // Original 21 Questions
            {
                question: "Before putting a boat back on its rack, what should you do?",
                answers: [
                    "Leave it on the dock for the next rower",
                    "Place it on stretchers/slings and wipe it down thoroughly",
                    "Rinse it with river water only",
                    "Ask a coach to inspect it"
                ],
                correctAnswer: 1,
                explanation: "Boats should be placed on stretchers/slings and thoroughly wiped down with a towel/rag before returning them to the rack."
            },
            {
                question: "When storing a boat back on the rack, the riggers should:",
                answers: [
                    "Face outward for easy access",
                    "Be removed completely",
                    "Align with those of other boats on the rack",
                    "Be rotated 90 degrees"
                ],
                correctAnswer: 2,
                explanation: "When storing boats, ensure the riggers align with those of other boats on the rack to maintain uniformity and balance."
            },
            {
                question: "Why is it important to disinfect oar handles after each row?",
                answers: [
                    "To prevent the wood from cracking",
                    "To maintain hygiene and prevent spread of germs, especially with blisters",
                    "To make them more grippy",
                    "It's not important; oar handles don't need cleaning"
                ],
                correctAnswer: 1,
                explanation: "Disinfecting oar handles is crucial for maintaining hygiene and preventing the spread of germs, especially given the likelihood of blisters and potential bleeding."
            },
            {
                question: "If you discover an issue with equipment, what should you do?",
                answers: [
                    "Fix it yourself",
                    "Leave it for someone else to discover",
                    "Note it in the logbook and notify a coach if significant",
                    "Use the equipment anyway to avoid canceling your row"
                ],
                correctAnswer: 2,
                explanation: "When you find equipment issues, note them in the logbook. If there is significant damage, also notify a coach or club officer immediately."
            },
            {
                question: "What is the proper way to access boats on high racks?",
                answers: [
                    "Climb on the racks themselves",
                    "Stand on another boat temporarily",
                    "Ask someone taller to help",
                    "Use the provided step ladders"
                ],
                correctAnswer: 3,
                explanation: "Always use the provided step ladders for reaching high racks; never climb on the racks themselves. Return ladders to their designated storage locations after use."
            },
            {
                question: "If you've used tape on the oar handles for blisters, what should you do afterward?",
                answers: [
                    "Leave it for the next person",
                    "Remove it completely, leaving no residue",
                    "Add an extra layer for the next person",
                    "Wrap it with plastic wrap"
                ],
                correctAnswer: 1,
                explanation: "If you've used tape on the handles for blisters, remove it completely after your row. Sticky residue makes handles uncomfortable for the next user."
            },
            {
                question: "What footwear rule applies in the boathouse?",
                answers: [
                    "Only waterproof shoes are allowed",
                    "No footwear restrictions",
                    "No street shoes on the dock or in boats",
                    "Only barefoot is allowed on docks"
                ],
                correctAnswer: 2,
                explanation: "Wear appropriate footwear in the boathouse. No street shoes on the dock or in the boats."
            },
            {
                question: "Who is responsible for ensuring the boathouse is locked when leaving?",
                answers: [
                    "Only coaches",
                    "The club president",
                    "Whoever arrives first in the morning",
                    "The last person leaving"
                ],
                correctAnswer: 3,
                explanation: "The last person leaving the boathouse is responsible for ensuring all doors and gates are locked."
            },
            {
                question: "What should you always do when using a boat?",
                answers: [
                    "Take a photo of it before and after",
                    "Record your usage in the logbook",
                    "Leave a deposit with the coach",
                    "Fill out an online form"
                ],
                correctAnswer: 1,
                explanation: "Always record your boat usage in the logbook, including any issues encountered during your row."
            },
            {
                question: "When rowing activities MUST be postponed due to lightning?",
                answers: [
                    "If lightning is seen within the previous 15 minutes",
                    "Only if it's directly overhead",
                    "If lightning is seen or thunder is heard within the previous 30 minutes",
                    "Only during official thunderstorm warnings"
                ],
                correctAnswer: 2,
                explanation: "Rowing activities MUST be postponed or curtailed if lightning is seen or thunder is heard within the previous 30 minutes."
            },
            {
                question: "What is the critical safety feature that must be checked at the bow of the boat?",
                answers: [
                    "Bow number",
                    "Club logo",
                    "Bow ball",
                    "Speed sensor"
                ],
                correctAnswer: 2,
                explanation: "The bow ball is a critical safety feature that must be securely attached and undamaged."
            },
            {
                question: "What is the proper traffic pattern to follow on the river?",
                answers: [
                    "Stay to the port (left) side",
                    "Stay to the starboard (right) side",
                    "Stay in the middle",
                    "Zigzag to avoid obstacles"
                ],
                correctAnswer: 1,
                explanation: "Always stay to the starboard (right) side of the river to prevent collisions."
            },
            {
                question: "How often should you look around while rowing?",
                answers: [
                    "Once per minute",
                    "Every 3-5 strokes",
                    "Only when turning",
                    "Only when the coach says to"
                ],
                correctAnswer: 1,
                explanation: "You should look around constantly, every 3-5 strokes, to maintain awareness of your surroundings."
            },
            {
                question: "What is the universal signal for distress on the water?",
                answers: [
                    "Waving one arm overhead",
                    "Repeatedly raising and lowering both arms overhead",
                    "Lying flat in the boat",
                    "Splashing the water"
                ],
                correctAnswer: 1,
                explanation: "The universal signal for distress on the water is repeatedly raising and lowering both arms overhead."
            },
            {
                question: "Which strap on the footstretcher is crucially important for safety in case of capsize?",
                answers: [
                    "Ankle straps",
                    "Heel restraints",
                    "Shoelace ties",
                    "Toe covers"
                ],
                correctAnswer: 1,
                explanation: "Heel restraints are crucially important as they limit heel lift and allow quick foot release in case of capsize."
            },
            {
                question: "What is the most important rule if you capsize?",
                answers: [
                    "Swim to shore immediately",
                    "Dive underwater to retrieve loose items",
                    "Stay with your boat",
                    "Remove your shoes"
                ],
                correctAnswer: 2,
                explanation: "The most important rule if you capsize is to stay with your boat. Your shell provides significant flotation, even if swamped."
            },
            {
                question: "What is the 'T-Position' used for during a capsize recovery?",
                answers: [
                    "The position your body should be in",
                    "A position created with the oars to provide stability",
                    "The way you hold the coach's hand",
                    "The direction you should swim"
                ],
                correctAnswer: 1,
                explanation: "The T-Position refers to arranging the oars perpendicular to the boat with blades flat on the water to create stability during re-entry."
            },
            {
                question: "When re-entering a boat after capsize, what body part should you focus on getting onto the boat first?",
                answers: [
                    "Your hands",
                    "Your feet",
                    "Your hips",
                    "Your head"
                ],
                correctAnswer: 2,
                explanation: "When re-entering, focus on driving your hips up and onto the gunwale/deck beside the cockpit. Aim to get your belly button over the edge."
            },
            {
                question: "What should you avoid doing when trying to get back into your boat after a capsize?",
                answers: [
                    "Using a dolphin kick",
                    "Pulling down on the far rigger/gunwale",
                    "Stabilizing with the oars",
                    "Using leg power"
                ],
                correctAnswer: 1,
                explanation: "Avoid pulling down on the far rigger/gunwale when trying to get in – this will likely just pull the boat over on top of you. Focus on kicking up and getting your hips onto the near side."
            },
            {
                question: "What action helps maintain boat longevity and shows respect for other rowers?",
                answers: [
                    "Using the equipment as hard as possible to 'break it in'",
                    "Letting the coach handle all cleaning duties",
                    "Proper care and cleaning after each use",
                    "Adding personal modifications"
                ],
                correctAnswer: 2,
                explanation: "Proper care and cleaning of equipment after each use helps maintain boat longevity and shows respect for other rowers who will use the equipment."
            },
             { // Existing Q21 - Renumbered to avoid conflict
                 question: "Before leaving the boathouse area with a shell, what quick inspection is recommended?",
                 answers: [
                     "Check the paint color",
                     "Check seat, rigger, stretchers for loose/broken parts",
                     "Measure the boat length",
                     "Polish the hull"
                 ],
                 correctAnswer: 1,
                 explanation: "Do a quick inspection of the seat, rigger, stretchers, etc., to ensure no parts are missing, loose, or broken before rowing."
             },
            // New Learner-Relevant Questions (29)
            { // Q1 (New)
                question: "What is the fundamental principle governing behavior at AARC, overriding specific rules if necessary?",
                answers: [
                    "Following the coach's direct orders",
                    "Prioritizing speed on the water",
                    "Common sense prevailing to ensure safety and prevent damage",
                    "Ensuring personal equipment is always used first"
                ],
                correctAnswer: 2,
                explanation: "The AARC Safety Rules state that 'Common sense must prevail - do not engage in behavior that jeopardizes any person's well-being or that may result in damage to equipment or facilities.'"
            },
            { // Q2 (New)
                question: "When storing a boat back on the rack, the riggers should:",
                answers: [
                    "Face outward for easy access",
                    "Be removed completely",
                    "Align with those of other boats on the rack",
                    "Be rotated 90 degrees"
                ],
                correctAnswer: 2,
                explanation: "When storing boats, ensure the riggers align with those of other boats on the rack to maintain uniformity and balance."
            },
             { // Q4 (New - originally Q5)
                 question: "What is the proper way to access boats on high racks?",
                 answers: [
                     "Climb on the racks themselves",
                     "Stand on another boat temporarily",
                     "Ask someone taller to help",
                     "Use the provided step ladders"
                 ],
                 correctAnswer: 3,
                 explanation: "Always use the provided step ladders for reaching high racks; never climb on the racks themselves. Return ladders to their designated storage locations after use."
             },
             { // Q5 (New - originally Q6)
                 question: "If you've used tape on the oar handles for blisters, what should you do afterward?",
                 answers: [
                     "Leave it for the next person",
                     "Remove it completely, leaving no residue",
                     "Add an extra layer for the next person",
                     "Wrap it with plastic wrap"
                 ],
                 correctAnswer: 1,
                 explanation: "If you've used tape on the handles for blisters, remove it completely after your row. Sticky residue makes handles uncomfortable for the next user."
             },
             { // Q6 (New - originally Q7)
                 question: "What footwear rule applies when getting into a boat?",
                 answers: [
                     "Only waterproof shoes are allowed",
                     "No footwear restrictions",
                     "No street shoes allowed in boats",
                     "Barefoot is required in boats"
                 ],
                 correctAnswer: 2,
                 explanation: "Wear appropriate footwear in the boathouse area, but no street shoes are allowed on the dock or in the boats."
             },
             { // Q7 (New - originally Q9)
                 question: "To ensure proper tracking and accountability, what should you always do when taking out or returning a club boat?",
                 answers: [
                     "Inform the coach verbally",
                     "Send an email to the club secretary",
                     "Record your usage accurately in the logbook",
                     "Post about it on social media"
                 ],
                 correctAnswer: 2,
                 explanation: "Always record your boat usage, including departure time, return time, and any issues, in the logbook."
             },
             { // Q8 (New - originally Q10)
                  question: "What is the minimum time rowing must stop after the LAST instance of hearing thunder OR seeing lightning?",
                  answers: [
                      "10 minutes",
                      "15 minutes",
                      "30 minutes",
                      "1 hour"
                  ],
                  correctAnswer: 2,
                  explanation: "Rowing activities MUST be postponed or curtailed if lightning is seen or thunder is heard within the previous 30 minutes."
              },
              { // Q9 (New - originally Q11)
                  question: "What critical safety feature at the front tip of the boat must be checked before launching?",
                  answers: [
                      "The boat's name sticker",
                      "The manufacturer's logo",
                      "The bow ball (must be secure and undamaged)",
                      "A speed sensor"
                  ],
                  correctAnswer: 2,
                  explanation: "The bow ball is a critical safety feature that must be securely attached and undamaged before every row."
              },
              { // Q10 (New - originally Q12)
                  question: "On most waterways, what is the standard traffic pattern rowers should follow?",
                  answers: [
                      "Stay to the left (port) side",
                      "Stay to the right (starboard) side",
                      "Weave between other boats",
                      "Follow the fastest boat"
                  ],
                  correctAnswer: 1,
                  explanation: "The standard traffic pattern is to stay to the starboard (right) side of the waterway relative to your direction of travel."
              },
               { // Q11 (New - originally Q13)
                  question: "To maintain awareness and avoid collisions, how often should you look over your shoulder while rowing?",
                  answers: [
                      "Only when you hear another boat",
                      "Approximately every 3-5 strokes",
                      "Once every few minutes",
                      "Only when the coach reminds you"
                  ],
                  correctAnswer: 1,
                  explanation: "You need to actively watch where you're going by looking over alternating shoulders approximately every 3-5 strokes."
              },
              { // Q12 (New - originally Q14)
                  question: "What is the universally recognized signal for distress on the water?",
                  answers: [
                      "Yelling loudly",
                      "Waving one arm frantically",
                      "Repeatedly raising and lowering BOTH arms overhead",
                      "Splashing water vigorously"
                  ],
                  correctAnswer: 2,
                  explanation: "The universal signal for distress on the water is repeatedly raising and lowering both arms overhead."
              },
              { // Q13 (New - originally Q15)
                  question: "What specific safety feature on the foot stretcher helps ensure you can get your feet out quickly in a capsize?",
                  answers: [
                      "The shoe size adjustment",
                      "The heel restraints",
                      "The tightness of the laces",
                      "The angle of the footplate"
                  ],
                  correctAnswer: 1,
                  explanation: "Heel restraints are crucially important safety features that limit how far your heels can lift, allowing quick foot release during a capsize."
              },
             { // Q14 (New - originally Q16)
                 question: "If you capsize, what is the MOST important thing to do immediately?",
                 answers: [
                     "Try to save your water bottle",
                     "Swim towards the nearest person",
                     "Stay with your boat for flotation",
                     "Check your hair"
                 ],
                 correctAnswer: 2,
                 explanation: "The most important rule if you capsize is to STAY WITH YOUR BOAT. It provides significant buoyancy, even when filled with water."
             },
             { // Q15 (New - originally Q17)
                 question: "During capsize recovery practice, what is the 'T-Position' used for?",
                 answers: [
                     "A special way to tread water",
                     "Arranging the oars perpendicular to the boat for stability",
                     "Signaling that you need tea",
                     "The shape your body makes when floating"
                 ],
                 correctAnswer: 1,
                 explanation: "The T-Position involves arranging the oars perpendicular (like a 'T') to the boat with blades flat on the water. This creates stability, making re-entry easier."
             },
             { // Q16 (New - originally Q18)
                 question: "When performing the side re-entry after a capsize, what part of your body should you primarily focus on getting onto the boat's edge first?",
                 answers: [
                     "Your elbow",
                     "Your knee",
                     "Your hips/belly button area",
                     "Your shoulder"
                 ],
                 correctAnswer: 2,
                 explanation: "Focus on using a strong leg kick to drive your HIPS up and onto the gunwale or deck beside the cockpit. Aim to get your belly button over the edge."
             },
             { // Q17 (New - originally Q19)
                 question: "What action should you AVOID when trying to pull yourself back into the boat?",
                 answers: [
                     "Kicking your legs powerfully",
                     "Pulling DOWN on the far side rigger or gunwale",
                     "Keeping the oars in the T-position",
                     "Rolling your body into the boat"
                 ],
                 correctAnswer: 1,
                 explanation: "Avoid pulling DOWN hard on the far side of the boat (opposite rigger/gunwale) as this is likely to pull the boat over on top of you. Focus on kicking UP and getting your hips onto the near side first."
             },
             { // Q18 (New - originally Q20)
                 question: "Consistently caring for and cleaning equipment after use primarily demonstrates:",
                 answers: [
                     "That you have too much free time",
                     "Respect for your future self, your peers, and the club's investment",
                     "That the equipment is brand new",
                     "That you are trying to impress the coaches"
                 ],
                 correctAnswer: 1,
                 explanation: "Proper equipment care shows respect for yourself (it'll be ready next time), your fellow rowers, and protects the club's financial investment in the equipment."
             },
             { // Q19 (New)
                 question: "According to the AARC Code of Conduct, besides coaches, who should members treat with respect and kindness?",
                 answers: [
                     "Only experienced rowers",
                     "Only members of their own crew",
                     "All club members, regardless of ability level",
                     "Only the club president"
                 ],
                 correctAnswer: 2,
                 explanation: "The Code of Conduct emphasizes treating all club members with equal respect and fairness, acknowledging varying ability levels."
             },
             { // Q20 (New)
                 question: "If you observe an immediate threat to safety (e.g., potential collision) while rowing in a coxed boat, what should you do?",
                 answers: [
                     "Stay silent and let the coxswain handle it",
                     "Alert others immediately",
                     "Discuss it with the stroke seat first",
                     "Wait until the boat stops"
                 ],
                 correctAnswer: 1,
                 explanation: "If an immediate safety threat is observed by a rower, the rower should alert others immediately, overriding the general 'no talking' rule."
             },
             { // Q21 (New)
                 question: "When meeting an oncoming boat, how should you typically pass?",
                 answers: [
                     "Starboard-to-starboard (right-to-right)",
                     "Port-to-port (left-to-left)",
                     "The faster boat decides",
                     "Pass on whichever side has more room"
                 ],
                 correctAnswer: 1,
                 explanation: "When meeting oncoming traffic, both boats should be on their respective starboard sides, resulting in a port-to-port passing situation."
             },
             { // Q22 (New)
                 question: "When carrying a boat with others, who typically gives the commands for lifting and moving?",
                 answers: [
                     "The strongest person",
                     "The person at the bow",
                     "The designated coxswain or person in charge of the carry",
                     "Everyone shouts commands together"
                 ],
                 correctAnswer: 2,
                 explanation: "Boat carries should be coordinated by a coxswain or designated person giving commands to ensure everyone lifts and moves together safely."
             },
             { // Q23 (New)
                 question: "What action is crucial for maximizing stability right after you manage to get back into the boat post-capsize?",
                 answers: [
                     "Immediately start bailing water",
                     "Quickly lift the oar handles slightly, keeping blades flat on the water",
                     "Check your foot stretchers",
                     "Adjust your seat position"
                 ],
                 correctAnswer: 1,
                 explanation: "Immediately lift the hand holding the oar handles and get the blades flat on the water for stability, as the boat will be tippy with water inside."
             },
              { // Q24 (New)
                 question: "What should you check regarding the oarlocks (gates) before launching?",
                 answers: [
                     "That they are freshly painted",
                     "That the gates close properly and hold the oar securely",
                     "That they are loose enough to spin freely",
                     "That they match the color of the boat"
                 ],
                 correctAnswer: 1,
                 explanation: "Ensure the oarlock gates close properly and hold the oar securely before launching."
             },
             { // Q25 (New)
                 question: "If you need to stop on the water for a short break, where is the safest place to do so?",
                 answers: [
                     "In the exact middle of the river",
                     "Close to the starboard shore, out of the main traffic flow",
                     "Underneath a bridge",
                     "Right next to another rowing boat"
                 ],
                 correctAnswer: 1,
                 explanation: "If you need to stop, move towards the starboard shore to get out of the primary traffic lane."
             },
             { // Q26 (New)
                 question: "What does the term 'Port' refer to on a boat?",
                 answers: [
                     "The front of the boat",
                     "The right side when facing forward",
                     "The left side when facing forward (rower's right when seated)",
                     "The back of the boat"
                 ],
                 correctAnswer: 2,
                 explanation: "Port is the left side of the boat when facing the bow. For the rower facing the stern, it is their right side."
             },
             { // Q27 (New)
                 question: "What does the term 'Starboard' refer to on a boat?",
                 answers: [
                     "The front of the boat",
                     "The right side when facing forward (rower's left when seated)",
                     "The left side when facing forward",
                     "The back of the boat"
                 ],
                 correctAnswer: 1,
                 explanation: "Starboard is the right side of the boat when facing the bow. For the rower facing the stern, it is their left side."
             },
             { // Q28 (New)
                  question: "What does the command 'Way enough' (or 'Weigh enough') mean?",
                  answers: [
                      "Start rowing harder",
                      "Stop rowing",
                      "Turn the boat",
                      "Check your balance"
                  ],
                  correctAnswer: 1,
                  explanation: "'Way enough' (sometimes spelled 'Weigh enough') is the command to stop rowing."
              },
              { // Q29 (New)
                  question: "What does the command 'Hold water' mean?",
                  answers: [
                      "Grab your water bottle",
                      "Stop the boat quickly by squaring blades in the water",
                      "Continue rowing but check your course",
                      "Bail water out of the boat"
                  ],
                  correctAnswer: 1,
                  explanation: "'Hold water' is a command to stop the boat quickly by squaring the blades vertically in the water to create drag."
              }

        ];


        // DOM elements (assuming they are defined as before)
        const startScreen = document.getElementById('start-screen');
        const quizScreen = document.getElementById('quiz-screen');
        const resultsScreen = document.getElementById('results-screen');
        const reviewScreen = document.getElementById('review-screen');
        const highscoresScreen = document.getElementById('highscores-screen');

        const startButton = document.getElementById('start-button');
        const viewHighscoresButton = document.getElementById('view-highscores');
        const restartButton = document.getElementById('restart-button');
        const reviewButton = document.getElementById('review-button');
        const highscoresButton = document.getElementById('highscores-button');
        const backToResultsButton = document.getElementById('back-to-results');
        const backButton = document.getElementById('back-button');
        const clearScoresButton = document.getElementById('clear-scores');

        const usernameInput = document.getElementById('username');
        const questionCounter = document.getElementById('question-counter');
        const timerElement = document.getElementById('timer');
        const scoreDisplay = document.getElementById('score-display');
        const questionText = document.getElementById('question-text');
        const answersContainer = document.getElementById('answers-container');
        const feedback = document.getElementById('feedback');
        const feedbackText = document.getElementById('feedback-text');

        const finalScore = document.getElementById('final-score');
        const timeTaken = document.getElementById('time-taken');
        const correctCount = document.getElementById('correct-count');
        const highScoreMessage = document.getElementById('high-score-message');

    const reviewContainer = document.getElementById('review-container');
    const highscoresBody = document.getElementById('highscores-body');
    const noScoresMessage = document.getElementById('no-scores-message');
    const highscoresTable = document.getElementById('highscores-table');


        // Quiz state variables (assuming defined as before)
         let currentQuestions = [];
         let currentQuestionIndex = 0;
         let score = 0;
         let correctAnswers = 0;
         let timer;
         let seconds = 0;
         let selectedAnswers = [];
         let quizComplete = false;
         let returnToScreen = null; // 'start' or 'results'


        // Initialization
        loadHighScores();

        // Event listeners
        startButton.addEventListener('click', startQuiz);
        viewHighscoresButton.addEventListener('click', () => {
            returnToScreen = 'start';
            showHighScores();
        });
        restartButton.addEventListener('click', resetQuiz);
        reviewButton.addEventListener('click', showReview);
        highscoresButton.addEventListener('click', () => {
            returnToScreen = 'results';
            showHighScores();
        });
        backToResultsButton.addEventListener('click', () => {
            hideAllScreens();
            resultsScreen.classList.remove('hidden');
        });
        backButton.addEventListener('click', () => {
            hideAllScreens();
             if (returnToScreen === 'results') {
                 resultsScreen.classList.remove('hidden');
             } else {
                 startScreen.classList.remove('hidden');
             }
             returnToScreen = null; // Reset return screen
        });
        clearScoresButton.addEventListener('click', clearHighScoresWithPassword); // Changed this line

        // Functions (assuming defined as before, with modifications below)

        function hideAllScreens() {
            startScreen.classList.add('hidden');
            quizScreen.classList.add('hidden');
            resultsScreen.classList.add('hidden');
            reviewScreen.classList.add('hidden');
            highscoresScreen.classList.add('hidden');
        }

        function startQuiz() {
            if (!usernameInput.value.trim()) {
                alert('Please enter your name to start the quiz.');
                return;
            }

            // Reset quiz state
            currentQuestionIndex = 0;
            score = 0;
            correctAnswers = 0;
            seconds = 0;
            selectedAnswers = [];
            quizComplete = false;
            scoreDisplay.textContent = `Score: ${score}`; // Reset score display

            // Get random questions
            currentQuestions = getRandomQuestions(20);

            // Start timer
            startTimer();

            // Show first question
            displayQuestion();

            // Switch to quiz screen
            hideAllScreens();
            quizScreen.classList.remove('hidden');
        }

        function getRandomQuestions(num) {
            const allQuestions = [...quizQuestions];
            const selectedQuestions = [];

            // Ensure we don't try to pick more questions than available
            const numToSelect = Math.min(num, allQuestions.length);

            for (let i = 0; i < numToSelect; i++) {
                const randomIndex = Math.floor(Math.random() * allQuestions.length);
                selectedQuestions.push(allQuestions.splice(randomIndex, 1)[0]);
            }

            return selectedQuestions;
        }


        function startTimer() {
            clearInterval(timer);
            seconds = 0;
            updateTimerDisplay();

            timer = setInterval(() => {
                 if (!quizComplete) { // Only increment if quiz is ongoing
                    seconds++;
                    updateTimerDisplay();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = seconds % 60;
            timerElement.textContent = `Time: ${minutes}:${remainingSeconds < 10 ? '0' : ''}${remainingSeconds}`;
        }

        function displayQuestion() {
             // Ensure currentQuestions is populated and index is valid
            if (!currentQuestions || currentQuestions.length === 0 || currentQuestionIndex >= currentQuestions.length) {
                console.error("Error: Question data not loaded or index out of bounds.");
                // Optionally end quiz or show an error message
                 endQuizWithError("Failed to load questions.");
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            questionCounter.textContent = `Question ${currentQuestionIndex + 1}/${currentQuestions.length}`;
            questionText.textContent = question.question;

            // Clear previous answers
            answersContainer.innerHTML = '';

            // 1. Build an array of original answer indexes
            const answerOrder = question.answers.map((_, i) => i);

            // 2. Shuffle it in place (Fisher–Yates)
            for (let i = answerOrder.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [answerOrder[i], answerOrder[j]] = [answerOrder[j], answerOrder[i]];
            }

            // 3. Render buttons in shuffled order
            answerOrder.forEach((origIdx, displayIndex) => {
                const btn = document.createElement('button');
                btn.className = 'answer-button';
                btn.textContent = `${String.fromCharCode(65 + displayIndex)}. ${question.answers[origIdx]}`;
                // Store the original index so selectAnswer can compare to question.correctAnswer
                btn.dataset.index = origIdx;
                btn.addEventListener('click', () => selectAnswer(origIdx));
                answersContainer.appendChild(btn);
            });

            // Hide feedback
            feedback.classList.add('hidden');
            feedback.classList.remove('correct-feedback', 'incorrect-feedback');
        }


         function selectAnswer(answerIndex) {
             // Prevent selecting answer after question is answered or if quiz is over
            if (feedback.classList.contains('hidden') === false || quizComplete) {
                return;
            }

             if (!currentQuestions || currentQuestionIndex >= currentQuestions.length) {
                console.error("Cannot select answer: quiz state error.");
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            const isCorrect = answerIndex === question.correctAnswer;

            // Store user's answer for review
            selectedAnswers.push({
                questionIndex: currentQuestionIndex,
                selectedAnswer: answerIndex,
                correct: isCorrect
            });

            // Update score
            if (isCorrect) {
                score += 1; // Award 1 point for correct answer
                correctAnswers++;
                scoreDisplay.textContent = `Score: ${score}`;
            }

            // Highlight selected answer and correct answer
            const buttons = answersContainer.querySelectorAll('.answer-button');
            buttons.forEach(button => {
                const buttonIndex = parseInt(button.dataset.index);

                if (buttonIndex === answerIndex) {
                    button.classList.add(isCorrect ? 'correct' : 'incorrect');
                }

                // Always show the correct answer, unless it was the one selected correctly
                if (buttonIndex === question.correctAnswer && !isCorrect) {
                    button.classList.add('correct');
                }

                // Disable all buttons after selection
                button.disabled = true;
            });

            // Show feedback with appropriate styling
            feedbackText.textContent = question.explanation;
            feedback.classList.remove('hidden');
            feedback.classList.add(isCorrect ? 'correct-feedback' : 'incorrect-feedback');


            // Move to next question after delay or end quiz
            setTimeout(() => {
                if (currentQuestionIndex < currentQuestions.length - 1) {
                    currentQuestionIndex++;
                    displayQuestion();
                } else {
                    endQuiz();
                }
            }, 3000); // Increased delay to allow reading feedback
        }


        function endQuiz() {
            quizComplete = true; // Mark quiz as complete
            clearInterval(timer); // Stop timer immediately


            // Update results screen
            finalScore.textContent = score;
            timeTaken.textContent = formatTime(seconds);
            correctCount.textContent = `${correctAnswers}/${currentQuestions.length}`; // Show X/Total

            // Check for high score
            const isHighScore = checkForHighScore();
            if (isHighScore) {
                highScoreMessage.innerHTML = '<p class="success">Congratulations! You made it to the high score board!</p>';
                saveHighScore();
            } else {
                highScoreMessage.innerHTML = '<p>Nice try! Keep practicing to make it to the high score board.</p>';
            }

            // Switch to results screen
            hideAllScreens();
            resultsScreen.classList.remove('hidden');
        }

         function endQuizWithError(message) {
            quizComplete = true;
            clearInterval(timer);
            hideAllScreens();
            resultsScreen.classList.remove('hidden');
            document.getElementById('quiz-summary').innerHTML = `<p style="color: red;">Error: ${message}</p>`;
            highScoreMessage.innerHTML = ''; // Clear high score message on error
        }


        function formatTime(totalSeconds) {
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        function checkForHighScore() {
            const highScores = getHighScores();
            if (highScores.length < 10) {
                return true; // Always a high score if fewer than 10 exist
            }
            // Check if current score is higher than the lowest high score,
            // or if scores are equal, check if time is faster
            const lowestHighScore = highScores[highScores.length - 1];
             if (score > lowestHighScore.score) {
                return true;
            } else if (score === lowestHighScore.score && seconds < lowestHighScore.time) {
                return true;
            }
            return false;

        }

        function saveHighScore() {
             const highScores = getHighScores();
             // Ensure username is captured correctly
             const userNameToSave = usernameInput.value.trim() || "Anonymous"; // Use Anonymous if name is blank

             const newScore = {
                 name: userNameToSave,
                 score: score,
                 time: seconds,
                 date: new Date().toLocaleDateString()
             };

             highScores.push(newScore);

             // Sort high scores by score (descending) and time (ascending)
             highScores.sort((a, b) => {
                 if (a.score !== b.score) {
                     return b.score - a.score;
                 }
                 return a.time - b.time;
             });

             // Keep only top 10
             if (highScores.length > 10) {
                 highScores.splice(10);
             }

             localStorage.setItem('aarc_quiz_highscores', JSON.stringify(highScores));
         }


        function getHighScores() {
            const highScores = localStorage.getItem('aarc_quiz_highscores');
            try {
                return highScores ? JSON.parse(highScores) : [];
            } catch (e) {
                console.error("Error parsing high scores from localStorage:", e);
                return []; // Return empty array on error
            }
        }

        function loadHighScores() {
             const highScores = getHighScores();
             highscoresBody.innerHTML = ''; // Clear previous entries

             if (highScores.length === 0) {
                 noScoresMessage.classList.remove('hidden');
                 highscoresTable.classList.add('hidden'); // Hide table if no scores
                 return;
             }

             noScoresMessage.classList.add('hidden');
             highscoresTable.classList.remove('hidden'); // Show table if scores exist


             highScores.forEach((scoreData, index) => { // Renamed 'score' to 'scoreData'
                 const row = document.createElement('tr');

                 const rankCell = document.createElement('td');
                 rankCell.textContent = index + 1;

                 const nameCell = document.createElement('td');
                 // Ensure name is displayed, default to 'Anonymous' if missing
                 nameCell.textContent = scoreData.name || "Anonymous";

                 const scoreCell = document.createElement('td');
                 scoreCell.textContent = scoreData.score; // Use scoreData.score

                 const timeCell = document.createElement('td');
                 timeCell.textContent = formatTime(scoreData.time); // Use scoreData.time

                 const dateCell = document.createElement('td');
                 dateCell.textContent = scoreData.date; // Use scoreData.date

                 row.appendChild(rankCell);
                 row.appendChild(nameCell);
                 row.appendChild(scoreCell);
                 row.appendChild(timeCell);
                 row.appendChild(dateCell);

                 highscoresBody.appendChild(row);
             });
         }

        function showHighScores() {
            loadHighScores();
            hideAllScreens();
            highscoresScreen.classList.remove('hidden');
             // 'returnToScreen' is set by the buttons calling this function
        }

        // *** MODIFIED FUNCTION FOR PASSWORD ***
        function clearHighScoresWithPassword() {
            const password = prompt('ADMIN ACTION: Please enter the password to clear all high scores:');
            // IMPORTANT: Replace 'AARC_2025' with a secure password management system in a real application.
            // This hardcoded password is for demonstration purposes only.
            const correctPassword = 'AARC_2025';

            if (password === null) {
                // User pressed Cancel
                return;
            }

            if (password === correctPassword) {
                if (confirm('Are you ABSOLUTELY sure you want to clear ALL high scores? This cannot be undone.')) {
                    localStorage.removeItem('aarc_quiz_highscores');
                    loadHighScores(); // Refresh the display
                    alert('High scores cleared successfully.');
                }
            } else {
                alert('Incorrect password. High scores were not cleared.');
            }
        }


        function showReview() {
             reviewContainer.innerHTML = ''; // Clear previous review items

             if (!selectedAnswers || selectedAnswers.length !== currentQuestions.length) {
                 reviewContainer.innerHTML = '<p>Could not load review. Please complete the quiz first.</p>';
                 hideAllScreens();
                 reviewScreen.classList.remove('hidden');
                 return;
             }


             selectedAnswers.forEach(answer => {
                  // Ensure the question exists for the given index
                 if (answer.questionIndex < 0 || answer.questionIndex >= currentQuestions.length) {
                     console.error(`Invalid question index ${answer.questionIndex} in selected answers.`);
                     return; // Skip this invalid entry
                 }
                 const question = currentQuestions[answer.questionIndex];


                 const reviewItem = document.createElement('div');
                 reviewItem.className = 'review-item';

                 const questionElement = document.createElement('div');
                 questionElement.className = 'review-question';
                 questionElement.textContent = `Q${answer.questionIndex + 1}: ${question.question}`;

                 const answersElement = document.createElement('div');
                 answersElement.className = 'review-answers';

                 question.answers.forEach((answerText, index) => {
                     const answerElement = document.createElement('div');
                     let label = `${String.fromCharCode(65 + index)}. ${answerText}`;
                     let answerClass = '';

                     if (index === question.correctAnswer) {
                         answerClass = 'review-correct';
                         label += ' (Correct Answer)';
                     }

                     if (index === answer.selectedAnswer) {
                         if (!answer.correct) {
                             answerClass = 'review-incorrect user-answer'; // Mark incorrect user choice
                             label += ' (Your Answer)';
                         } else {
                             // If user selected the correct answer, keep review-correct class
                              label += ' (Your Answer)';
                         }
                     }


                     answerElement.className = answerClass;
                     answerElement.textContent = label;

                     answersElement.appendChild(answerElement);
                 });

                 const explanationElement = document.createElement('div');
                 explanationElement.className = 'review-explanation';
                 explanationElement.textContent = `Explanation: ${question.explanation}`;

                 reviewItem.appendChild(questionElement);
                 reviewItem.appendChild(answersElement);
                 reviewItem.appendChild(explanationElement);

                 reviewContainer.appendChild(reviewItem);
             });

             hideAllScreens();
             reviewScreen.classList.remove('hidden');
         }


         function resetQuiz() {
            // Clear timer just in case it's running
            clearInterval(timer);
            quizComplete = false; // Ensure quiz can be restarted
            // Reset score display on start screen if needed (optional)
            // Reset username field? Maybe not, keep it for convenience.
            hideAllScreens();
            startScreen.classList.remove('hidden');
        }

    });
</script>
